import{components as w}from"vuetify";import{defineComponent as C,ref as V,openBlock as c,createBlock as m,withCtx as t,createTextVNode as p,createVNode as n,createElementBlock as h,Fragment as g,toDisplayString as _,createCommentVNode as D,renderList as U,onMounted as b,onBeforeUnmount as L,computed as N,resolveComponent as S}from"vue";import{navigateTo as A,getCurrentRoute as k}from"@browser-module/api/nav";import{getUserLogin as y}from"@browser-module/api/user";import{useRoute as B}from"vue-router";const E=async e=>{if(!e)return[];const r=y();if(!r.includes(e))return[];const a=[{name:e}];return e!==r&&r.includes(e)&&a.unshift({name:r}),a},M=async e=>{if(!e)return null;const r=y();if(e!=r)return null;const a=["account","rumors","app4","app5","app6","app7","app8","app9","app11","app12","app13","app14","app15","app16","app17","app18"];return e==="admin"&&a.push("admin"),a.sort(Q),{name:e,permissions:a}},Q=(e,r)=>{const a=/(\D+)(\d+)?/,u=e.match(a),i=r.match(a);if(!u||!i)throw new Error("Unexpected non-matching string format");const[,d,s]=u,[,l,o]=i;return d<l?-1:d>l?1:s!==void 0&&o!==void 0?parseInt(s)-parseInt(o):s!==void 0?-1:o!==void 0?1:0},F=C({name:"SearchUser",setup(){const e=V(""),r=V([]);return{searchQuery:e,users:r,searchUsers:async()=>{e.value.length>2?r.value=await E(e.value):r.value=[]},goToUserDetails:i=>{A({path:`/admin/users/details/${i}`})}}}}),T=(e,r)=>{const a=e.__vccOpts||e;for(const[u,i]of r)a[u]=i;return a},{VTextField:P,VListItemTitle:R,VListItem:z,VList:W,VContainer:j}=w;function O(e,r,a,u,i,d){return c(),m(j,{fluid:""},{default:t(()=>[p(" Search: "),n(P,{modelValue:e.searchQuery,"onUpdate:modelValue":r[0]||(r[0]=s=>e.searchQuery=s),label:"Input user name",flat:"",clearable:"","prepend-inner-icon":"mdi-magnify",onInput:e.searchUsers},null,8,["modelValue","onInput"]),e.users.length?(c(),h(g,{key:0},[p(" Found user"+_(e.users.length>1?"s":"")+" ",1),e.users.length>1||!e.users.map(s=>s.name).includes(e.searchQuery)?(c(),h(g,{key:0},[p(" with name like *"+_(e.searchQuery)+"* ",1)],64)):D("",!0),n(W,null,{default:t(()=>[(c(!0),h(g,null,U(e.users,s=>(c(),m(z,{key:s.name,onClick:l=>e.goToUserDetails(s.name)},{default:t(()=>[n(R,null,{default:t(()=>[p(_(s.name),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})],64)):D("",!0)]),_:1})}const q=T(F,[["render",O]]),G=C({name:"UserDetails",setup(){const e=B(),r=V(null);return b(async()=>{const a=e.params.name;a&&(r.value=await M(a))}),{userDetails:r}}}),{VIcon:H,VAvatar:J,VCol:v,VRow:$,VCardTitle:K,VDivider:X,VChip:Y,VCardText:Z,VCard:x,VContainer:ee}=w;function te(e,r,a,u,i,d){return c(),m(ee,null,{default:t(()=>[n($,{justify:"center"},{default:t(()=>[n(v,{cols:"12"},{default:t(()=>[n(x,{class:"pa-2"},{default:t(()=>[n(K,null,{default:t(()=>[n($,{align:"center"},{default:t(()=>[n(v,{cols:"auto"},{default:t(()=>[n(J,null,{default:t(()=>[n(H,null,{default:t(()=>[p("mdi-account")]),_:1})]),_:1})]),_:1}),n(v,null,{default:t(()=>[p(_(e.userDetails?.name),1)]),_:1})]),_:1})]),_:1}),n(X),n(Z,null,{default:t(()=>[n($,null,{default:t(()=>[n(v,{cols:"12"},{default:t(()=>[p(" Permissions: ")]),_:1})]),_:1}),n($,null,{default:t(()=>[(c(!0),h(g,null,U(e.userDetails?.permissions,s=>(c(),m(v,{key:s,cols:"auto"},{default:t(()=>[n(Y,null,{default:t(()=>[p(_(s),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}const ne=T(G,[["render",te]]);function ge(e){return[{path:"users",component:q,alias:["","users"]},{path:"users/details/:name",component:ne},{path:":pathMatch(.*)*",redirect:`${e}/users`}]}const re=C({name:"Admin",setup(){const e=V(!1),r=y(),a=V(!1),u=()=>{const o=parseFloat(getComputedStyle(document.documentElement).fontSize);a.value=window.innerWidth>=o*32};b(()=>{u(),window.addEventListener("resize",u)}),L(()=>{window.removeEventListener("resize",u)});const i=N(()=>[{title:"Users",icon:"mdi-account-search-outline",exact:!0,path:"/admin/users",alias:"/admin"},{title:"User",icon:"mdi-account-outline",exact:!1,path:"/admin/users/details/",pathClcik:`/admin/users/details/${r}`,altTitle:"User (Me)"}]);function d(o){const f=k().path;return o.exact?!!(f===o.path||o.alias&&f===o.alias):!!f.startsWith(o.path)}function s(o){const f=k().path;return o.pathClcik&&f===o.pathClcik&&o.altTitle||o.title}function l(){e.value=!e.value}return{drawer:e,items:i,isActive:d,getTitle:s,toggleDrawer:l,isLargeScreen:a}}}),{VAppBarNavIcon:ae,VToolbarTitle:oe,VAppBar:se,VIcon:le,VListItemTitle:ue,VListItem:ie,VList:ce,VNavigationDrawer:pe,VContainer:I}=w;function de(e,r,a,u,i,d){const s=S("router-view");return c(),m(I,{fluid:""},{default:t(()=>[n(se,{app:""},{default:t(()=>[n(ae,{onClick:e.toggleDrawer},null,8,["onClick"]),n(oe,null,{default:t(()=>[p("Admin Panel")]),_:1})]),_:1}),n(pe,{modelValue:e.drawer,"onUpdate:modelValue":r[0]||(r[0]=l=>e.drawer=l),app:"",clipped:e.isLargeScreen,permanent:e.isLargeScreen},{default:t(()=>[n(ce,{dense:""},{default:t(()=>[(c(!0),h(g,null,U(e.items,(l,o)=>(c(),m(ie,{key:o,to:l.pathClcik||l.path,router:"",active:e.isActive(l)},{prepend:t(()=>[n(le,null,{default:t(()=>[p(_(l.icon),1)]),_:2},1024)]),default:t(()=>[n(ue,null,{default:t(()=>[p(_(e.getTitle(l)),1)]),_:2},1024)]),_:2},1032,["to","active"]))),128))]),_:1})]),_:1},8,["modelValue","clipped","permanent"]),n(I,{fluid:""},{default:t(()=>[n(s)]),_:1})]),_:1})}const Ve=T(re,[["render",de]]);export{ge as createRouteChildren,Ve as default};
